---
import type { GetStaticPaths } from "astro";
import Layout from "../../layouts/Layout.astro";
import Cards from "../../components/Cards.astro";
import Recommended from "../../components/Recommended.astro";
import { array } from "astro:schema";

export const getStaticPaths: GetStaticPaths = async () => {
  const res = await fetch(`https://rickandmortyapi.com/api/character`);
  const data = await res.json();

  const total = data.info.count;

  const paths = Array.from({ length: total }, (_, i) => ({
    params: { id: `${i + 1}` },
  }));

  console.log('paths', paths);

  return paths;
};

const { id } = Astro.params;
const response = await fetch(`https://rickandmortyapi.com/api/character/${id}`);
const character = await response.json();

console.log(character);
---

<Layout>
  <section>
    <div class="flex flex-row flex-wrap min-h-auto justify-center border-b border-b-neutral-800 pb-5">
      <Cards name={character.name} species={character.species} image={character.image}/>
    </div>
  </section>
  <Recommended/>
</Layout>
